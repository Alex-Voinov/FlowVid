import os

def app_dir() -> str:
    """
    Возвращает корневую директорию приложения.

    Зачем:
        Используется как точка отсчёта для всех остальных путей —
        профилей, логов, конфигураций. Позволяет скрипту корректно
        находить файлы независимо от того, откуда он был запущен.
    """
    return os.path.dirname(os.path.abspath(os.getcwd()))


def profiles_dir() -> str:
    """
    Возвращает путь к директории с профилями приложения (./profiles)
    и гарантирует её создание.

    Зачем:
        В этой папке хранятся индивидуальные профили браузеров,
        данные сессий, куки, настройки. Это позволяет загрузчикам
        запускать Selenium с уже авторизованными аккаунтами, чтобы
        пользователю не приходилось каждый раз логиниться.
    """
    p = os.path.join(os.getcwd(), "profiles")
    os.makedirs(p, exist_ok=True)
    return p


def chrome_profiles_dir() -> str:
    """
    Возвращает путь к директории профилей Chrome (./profiles/chrome)
    и гарантирует её создание.

    Зачем:
        Каждая социальная сеть получает свой изолированный профиль Chrome,
        чтобы:
           - не мешались куки разных сайтов,
           - не происходили конфликты авторизаций,
           - Selenium мог запускаться стабильно и повторяемо.
    """
    p = os.path.join(profiles_dir(), "chrome")
    os.makedirs(p, exist_ok=True)
    return p


def site_profile(site_name: str) -> str:
    """
    Возвращает путь к профилю конкретного сайта
    (например: ./profiles/chrome/YouTube/) и создаёт его при необходимости.

    Зачем:
        Каждый загрузчик соцсети работает через свой выделенный профиль:
            - сохраняет куки,
            - сохраняет авторизованную сессию,
            - исключает разлогины,
            - позволяет многократно запускать программу без повторных входов.

        site_name должен совпадать с названием платформы в менеджере загрузчиков.
    """
    p = os.path.join(chrome_profiles_dir(), site_name)
    os.makedirs(p, exist_ok=True)
    return p


def ensure_dirs():
    """
    Создаёт базовые директории приложения, если они отсутствуют:
        - профили браузеров,
        - директория логов.

    Зачем:
        Это инициализирующая функция, вызываемая при старте программы,
        чтобы гарантировать правильную файловую структуру. Исключает ошибки,
        связанные с отсутствием необходимых директорий.
    """
    chrome_profiles_dir()
    logs_dir = os.path.join(os.getcwd(), "logs")
    os.makedirs(logs_dir, exist_ok=True)
